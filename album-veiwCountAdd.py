# coding=utf-8
import cookielib,urllib,random
from urllib2 import build_opener,Request,HTTPCookieProcessor,URLError

'''
    此部分为浏览指定专辑的方法
'''
opener = build_opener(HTTPCookieProcessor(cookielib.CookieJar()))
albums = range(3105662,3105873)
# recipids = [441963, 442069, 442072, 442074, 442075, 442076, 442077, 442078, 442093, 442094, 442095, 442123, 442125,
#             442126, 442129, 442166, 442169, 442222, 442223, 442267, 442277, 442279, 442284, 442286, 442323, 442347,
#             442348, 442349, 442350, 442351, 442354, 442356, 442357, 442358, 442359, 442361, 442362, 442363, 442365,
#             442366, 442367, 442369, 442370, 442372, 442373, 442374, 442376, 442381, 442382, 442383, 442384, 442386,
#             442387, 442389, 442391, 442392, 442393, 442396, 442397, 442398, 442399, 442400, 442401, 442402, 442403,
#             442404, 442405, 442406, 442407, 442408, 442409, 442410, 442411, 442412, 442413, 442414, 442415, 442416,
#             442417, 442418, 442419, 442420, 442421, 442422, 442423, 442424, 442425, 442426, 442427, 442428, 442429,
#             442430, 442431, 442432, 442433, 442434, 442435, 442436, 442437, 442438, 442439, 442440, 442441, 442442,
#             442443, 442444, 442445, 442446, 442447, 442448, 442449, 442450, 442451, 442452, 442453, 442454, 442455,
#             442456, 442457, 442458, 442459, 442460, 442462, 442464, 442465, 442466, 442467, 442468, 442469, 442470,
#             442471, 442472, 442473, 442475, 442476, 442477, 442478, 442479, 442480, 442481, 442482, 442483, 442484,
#             442486, 442487, 442488, 442489, 442493, 442494, 442495, 442497, 442498, 442499, 442500, 442501, 442502,
#             442503, 442504, 442505, 442506, 442507, 442508, 442509, 442510, 442511, 442512, 442513, 442514, 442515,
#             442516, 442517, 442518, 442520, 442522, 442523, 442524, 442525, 442526, 442527, 442528, 442529, 442530,
#             442531, 442532, 442535, 442536, 442537, 442538, 442539, 442540, 442541, 442542, 442543, 442544, 442545,
#             442546, 442547, 442548, 442549, 442550, 442551, 442552, 442553, 442554, 442555, 442556, 442557, 442558,
#             442559, 442560, 442561, 442562, 442563, 442564, 442565, 442566, 442567, 442568, 442569, 442570, 442571,
#             442572, 442573, 442574, 442575, 442576, 442577, 442578, 442579, 442580, 442581, 442582, 442583, 442584,
#             442585, 442586, 442587, 442588, 442621, 442626, 442628, 442640, 442641, 442642, 442643, 442644, 442645,
#             442646, 442647, 442648, 442649, 442650, 442651, 442652, 442653, 442654, 442655, 442656, 442658, 442659,
#             442660, 442661, 442662, 442663, 442664, 442665, 442666, 442667, 442668, 442669, 442670, 442671, 442672,
#             442673, 442674, 442679, 442680, 442681, 442682
# ]

succeselist = []
succeseCount =0
i=0

for i in range(1,2000):
    albumid = random.choice(albums)
    rescode=0
    res=None
    try:
        res = opener.open(Request('http://www.haodou.com/recipe/album/%s/'%albumid))
        rescode = 200
        succeseCount+=1
    except URLError as e:
        if hasattr(e,'code'):
            rescode = e.code
        elif hasattr(e,'reason'):
            rescode = e.reason
    finally:
        print i,'complete,',albumid,'resp:',rescode
        if res :
            res.close()
    i+=1


print 'succese:\n',succeseCount